<!DOCTYPE html>
<html lang="en">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>Structure from Motion | Cayman</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1671.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 14.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1"><meta name="generator" content="Hugo 0.55.6" />    <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style><span class="Apple-converted-space"> </span></span></p>
</body>
</html>

<body>
  <section class="page-header">
  <h1 class="project-name">
    Cayman Hugo Theme
  </h1>
  <h2 class="project-tagline">
    A clean, responsive Hugo theme, ported from the original Jekyll Cayman theme
  </h2>
  <nav>
    
    
      
      
      
      
      <a href="/" class="btn">Blog</a>
    
      
      
      
      
      <a href="/tags/" class="btn">Tags</a>
    
      
      
      
      
      <a href="/about/" class="btn">About</a>
    
      
      
      
      
      <a href="/index.xml" class="btn">RSS</a>
    
  </nav>
</section>

  <section class="main-content">
    
  <h1>Structure from Motion</h1>
  

<p>Structure‐from‐Motion 要解决的问题是从多张图片或者视频流中恢复物体的三维结构和相机位姿。可以通过构建相机模型然后对重投影误差进行优化来求解。</p>

<p><img src="https://github.com/zkyue/Picturefloor/raw/master/sfm.jpg" alt="sfm" /></p>

<h4 id="formulation">Formulation</h4>

<p>Input:  $p<em>{ij}=(v</em>{ij},u_{ij})$ 第 $i$ 个对应点在第 $j$ 张图片的位置</p>

<p>Output：</p>

<ul>
<li>$X_i$, 对应点$p_i$ 的三维坐标</li>
<li>$R_j, t_j$,  第 $ j$ 个相机的旋转和平移</li>
</ul>

<p>Cost：
$$
g(X,R,T)=\sum<em>{i=1}^m\sum</em>{j=1}^m\begin{Vmatrix} P(X_i,R_j,t<em>j)- \left[\begin{matrix}
   u</em>{i,j} <br />
   v_{i,j}
  \end{matrix}\right]   \end{Vmatrix}   ^2 \tag{1}
$$</p>

<h4 id="bundle-adjustment">Bundle Adjustment</h4>

<p>对上面的 Cost 函数进行优化叫做 Bundle Adjustment， 取自对通过一个点的一捆光线进行调整之意，一个很 intuitive 的名字。</p>

<p>Bundle Adjustment 一般采用 Levenberg‐Marquardt 进行优化，它是 Gauss‐Newton 的改进版。</p>

<h5 id="gauss-newton">Gauss‐Newton</h5>

<p>Gauss‐Newton 可以解决任意的非线性优化问题，工作过程如下：</p>

<ol>
<li>对待优化函数取一阶近似：</li>
</ol>

<p>$$
f(P_i+\Delta)\approx f(P_i)+J\Delta
$$</p>

<ol>
<li>最小化该一阶近似：</li>
</ol>

<p>$$
\Delta=\mathop{\arg\min}\ \ | f(P_i)+J\Delta|^2
$$</p>

<ol>
<li>迭代升级直到收敛：</li>
</ol>

<p>$$
P_{i+1}=P_i+\Delta
$$</p>

<h5 id="apply-gauss-newton-to-ba">Apply Gauss‐Newton to BA</h5>

<p>将（1）式改写为：
$$
f(P)=g(X,R,T)=\sum<em>{i,j}e</em>{ij}^2(X,R,T)
$$
线性近似得：
$$
f(P<em>0)=\sum</em>{ij}(e_{ij}(P<em>0)+J</em>{ij}\Delta)^2\approx c+2b^T\Delta+\Delta^TH\Delta \tag{2}
$$
其中：
$$
b^T=\sum<em>{ij}e^T</em>{ij}J<em>{ij}\ , H=\sum</em>{ij}J<em>{ij}^TJ</em>{ij}
$$
最小化（2）式：
$$
H\Delta=-b \tag{3}
$$
迭代：
$$
P\leftarrow P+\Delta
$$</p>

<h5 id="levenberg-marquardt">Levenberg‐Marquardt</h5>

<p>Gauss‐Newton 的优点是收敛速度很快，但是步长过大的话有可能不收敛，而梯度下降总是收敛的，但在梯度很小时收敛的很慢，Levenberg‐Marquardt 试图在这二者之间取得平衡。</p>

<p>$H$ 的对角线上的元素为梯度，Levenberg‐Marquardt 将（3）式调整为：
$$
(H+\lambda I)\Delta=-b
$$
通过控制  $\lambda$ 的大小来决定迭代时主要是梯度下降或 Gauss‐Newton 在起作用，比较迭代前后 cost 的大小可以知道当前的   $\lambda$ 大小是否合适。</p>


    <footer class="site-footer">
  <span class="site-footer-credits">
    Made with <a href="https://gohugo.io/">Hugo</a>. Themed by <a href="https://github.com/zwbetz-gh/cayman-hugo-theme">Cayman</a>. Deployed to <a href="https://www.netlify.com/">Netlify</a>.
  </span>
</footer>

  </section>
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

</body>
</html>
